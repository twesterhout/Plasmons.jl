<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · Plasmons.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Plasmons.jl</span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Installing-1"><span>Installing</span></a></li><li><a class="tocitem" href="#Using-the-executable-1"><span>Using the executable</span></a></li><li><a class="tocitem" href="#Algorithm-1"><span>Algorithm</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/twesterhout/Plasmons.jl/blob/master/docs/src/index.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Plasmons.jl-1"><a class="docs-heading-anchor" href="#Plasmons.jl-1">Plasmons.jl</a><a class="docs-heading-anchor-permalink" href="#Plasmons.jl-1" title="Permalink"></a></h1><h2 id="Installing-1"><a class="docs-heading-anchor" href="#Installing-1">Installing</a><a class="docs-heading-anchor-permalink" href="#Installing-1" title="Permalink"></a></h2><p>Plasmons.jl can be used either as a Julia package or as a standalone executable. The latter option is provided for people who do not care about Julia and just want to do physics. If you are one of them just download <code>Plasmons.sif</code> executable file from the <a href="https://github.com/twesterhout/Plasmons.jl/releases">Releases</a> page and you are good to go.</p><p>Otherwise, install Plasmons.jl using Pkg:</p><pre><code class="language-julia">import Pkg; Pkg.add(url=&quot;https://github.com/twesterhout/Plasmons.jl&quot;)</code></pre><h2 id="Using-the-executable-1"><a class="docs-heading-anchor" href="#Using-the-executable-1">Using the executable</a><a class="docs-heading-anchor-permalink" href="#Using-the-executable-1" title="Permalink"></a></h2><p>After downloading the container (<code>Plasmons.sif</code> file) from the <a href="https://github.com/twesterhout/Plasmons.jl/releases">Releases</a> page one can simply run it. It follows the UNIX philosophy and tries to do one thing and do it well.</p><p>The one thing is calculating polarizability <span>$\chi$</span> (or dielectric function <span>$\varepsilon$</span>). It can be described by the following two functions:</p><div>\[\begin{aligned}
    \left(H, \omega, \mu, T\right) &amp;\mapsto \chi \\
    \left(\chi, V\right) &amp;\mapsto \varepsilon
\end{aligned}\]</div><p>This means that if you provide a Hamiltonian <span>$H$</span> and frequency <span>$\omega$</span> (and some information about the environment, namely chemical potential <span>$\mu$</span> and temperature <span>$T$</span>), <code>Plasmons.sif</code> will compute <span>$\chi(\omega)$</span> for your system. If you additionally provide unscreened Coulomb interaction <span>$V$</span>, <code>Plasmons.sif</code> will compute <span>$varepsilon(\omega)$</span> as well.</p><h2 id="Algorithm-1"><a class="docs-heading-anchor" href="#Algorithm-1">Algorithm</a><a class="docs-heading-anchor-permalink" href="#Algorithm-1" title="Permalink"></a></h2><p>Within real-space RPA (Random Phase Approximation) the calculation of polarizability matrix <span>$\chi(\omega)$</span> amounts to evaluation of the following equation</p><div>\[\begin{aligned}
    \chi_{a,b}
        &amp;= \langle a |\hat\chi| b \rangle
        = 2\cdot \sum_{i,j} \langle i |\hat G| j \rangle
           \langle j | a \rangle \langle a | i \rangle
           \langle i | b \rangle \langle b | j \rangle\; , \\
    G_{i,j}
        &amp;= \langle i | \hat G | j \rangle
        = \frac{f_i - f_j}{E_i - E_j - (\hbar\omega + i\eta)} \;.
\end{aligned}\]</div><p>Here <span>$E_i$</span>s are energy eigenvalues, <span>$\langle a | i \rangle = \psi_i (a)$</span> are energy eigenstates, <span>$f_i = f(E_i)$</span> is the occupation of the <span>$i$</span>&#39;th state given by the Fermi-Dirac distribution, <span>$\eta$</span> is Landau damping, and <span>$\omega$</span> is the frequency.</p><p>First of all, for a given temperature <span>$T$</span> and chemical potential <span>$\mu$</span>, we compute occupation numbers <span>$f(E_i)$</span>.</p><article class="docstring"><header><a class="docstring-binding" id="Plasmons.fermidirac" href="#Plasmons.fermidirac"><code>Plasmons.fermidirac</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">fermidirac(E; mu, kT) -&gt; f</code></pre><p>Return Fermi-Dirac distribution <span>$f$</span> at energy <code>E</code>, chemical potential <code>mu</code>, and temperature <code>kT</code>. Note that <code>kT</code> is assumed to be temperature multiplied by the Boltzmann constant, i.e. physical dimension of <code>kT</code> is the same as <code>E</code> (e.g. electron-volts).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/twesterhout/Plasmons.jl/blob/71d23f8f769365d94c2f03c28033a87eb4eec269/src/Plasmons.jl#LL14-L20">source</a></section></article><p>Next, we compute the matrix <span>$G$</span>. This is done by either <a href="#Plasmons._g"><code>Plasmons._g</code></a> or <a href="#Plasmons._g_blocks"><code>Plasmons._g_blocks</code></a> functions.</p><article class="docstring"><header><a class="docstring-binding" id="Plasmons._g" href="#Plasmons._g"><code>Plasmons._g</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">_g(ħω, E; mu, kT) -&gt; G</code></pre><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This is an internal function!</p></div></div><p>Compute matrix G</p><div>\[    G_{ij} = \frac{f(E_i) - f(E_j)}{E_i - E_j - \hbar\omega}\]</div><p>where <span>$f$</span> is <a href="https://en.wikipedia.org/wiki/Fermi%E2%80%93Dirac_statistics">Fermi-Dirac distribution</a> at chemical potential <code>mu</code> (<span>$\mu$</span>) and temperature <code>kT</code> (<span>$k_B T$</span>). <code>E</code> is a vector of eigenenergies. <code>ħω</code> is a complex frequency including Landau damping (i.e.  <span>$\hbar\omega + i\eta$</span>). All arguments are assumed to be in energy units.</p><p>Sometimes one can further exploit the structure of <span>$G$</span>. For <span>$E \ll \mu$</span> or <span>$E \gg \mu$</span> Fermi-Dirac distribution is just a constant and <span>$G$</span> goes to 0 for all <span>$\omega$</span>. <a href="#Plasmons._g_blocks"><code>Plasmons._g_blocks</code></a> uses this fact to construct a block-sparse version of <span>$G$</span>. The reason why such a block-sparse version is useful will become apparent later.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/twesterhout/Plasmons.jl/blob/71d23f8f769365d94c2f03c28033a87eb4eec269/src/Plasmons.jl#LL24-L44">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Plasmons._g_blocks" href="#Plasmons._g_blocks"><code>Plasmons._g_blocks</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">_g_blocks(ħω, E; mu, kT) -&gt; (Gᵣ, Gᵢ)</code></pre><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This is an internal function!</p></div></div><p>Calculate matrix <span>$G$</span> given a vector of eigenenergies <code>E</code>, chemical potential <code>mu</code>, and temperature <code>kT</code>. See <a href="#Plasmons._g"><code>_g</code></a> for the definition of <span>$G$</span>.</p><p>Compared to <a href="#Plasmons._g"><code>_g</code></a> this function applies to tricks:</p><ul><li><code>G</code> is split into real and imaginary parts <code>Gᵣ</code> and <code>Gᵢ</code>.</li><li>We exploit the &quot;block-sparse&quot; structure of <code>G</code> (see <a href="@ref"><code>Plasmons._ThreeBlockMatrix</code></a>).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/twesterhout/Plasmons.jl/blob/71d23f8f769365d94c2f03c28033a87eb4eec269/src/Plasmons.jl#LL59-L72">source</a></section></article><p>Let us now turn to the computation of polarizability matrix <span>$\chi$</span>. The naive approach is to write 4 nested loops. However, this is tremendously slow! A slightly better approach which I used for my Bachelor thesis is to rewrite the computation of each <span>$\chi_{a, b}$</span> as a combination of <code>GEMV</code> and <code>DOT</code> operations:</p><div>\[\begin{aligned}
    \chi_{a, b}
        &amp;= \sum_{i, j} \left(\langle a | i \rangle \langle i | b \rangle\right)
            G_{i, j}
            \left(\langle j | a \rangle \langle b | j \rangle\right)
         = A(a,b)^\dagger G A(a,b) \;, \\
        &amp;\text{where } A(a,b)_j = \langle j | a \rangle \langle b | j \rangle \;.
\end{aligned}\]</div><p>We use the following data structure to hold <span>$A$</span> as well as the temporary <span>$G A$</span>.</p><article class="docstring"><header><a class="docstring-binding" id="Plasmons._Workspace" href="#Plasmons._Workspace"><code>Plasmons._Workspace</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">_Workspace{&lt;: AbstractArray}</code></pre><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This is an internal data structure!</p></div></div><p>A workspace which is used by <a href="@ref"><code>polarizability</code></a> function to avoid allocating many temporary arrays. Stores two attributes:</p><ul><li>A vector <code>A</code> which is defined by <span>$A_j = \langle j | a \rangle \langle b | j \rangle$</span>.</li><li>A vector <code>temp</code> which is the product <span>$G A$</span>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/twesterhout/Plasmons.jl/blob/71d23f8f769365d94c2f03c28033a87eb4eec269/src/Plasmons.jl#LL101-L112">source</a></section></article><p><strong>TODO</strong>: Finish this.</p></article></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Saturday 9 January 2021 01:49">Saturday 9 January 2021</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
